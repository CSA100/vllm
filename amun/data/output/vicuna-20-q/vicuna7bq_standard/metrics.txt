python3 vllm_test.py --lmp="lmsys/vicuna-13b-v1.5" --smp="/home/chaanan/.cache/huggingface/hub/models--Chaanan--vicuna-7b-v1.5-W8A8-Dynamic-Per-Token/snapshots/d607e7f6393d17f42e546fa2827484d69de6dd29" --mepp=20 --pf="./data/input/vicuna_g_cf.jsonl" --ptf="./data/prompt_templates.jsonl" --gpu_mem="0.9" --qkv="False" --out_dir="./data/output/"

>>>>>> Batch Test Configuration >>>>>>
Large Model Path: lmsys/vicuna-13b-v1.5
Small Model Path: /home/chaanan/.cache/huggingface/hub/models--Chaanan--vicuna-7b-v1.5-W8A8-Dynamic-Per-Token/snapshots/d607e7f6393d17f42e546fa2827484d69de6dd29
Max Expansion Phase Parallelization: 20
Prompt File: ./data/input/vicuna_g_cf.jsonl
Prompt Template File: ./data/prompt_templates.jsonl
GPU Memory Utilization: 0.9
Quantize KV Cache: True
<<<<<< Batch Test Configuration <<<<<<

INFO 09-17 11:02:13 llm_engine.py:245] Initializing an LLM engine (v0.6.0) with config: model='/home/chaanan/.cache/huggingface/hub/models--Chaanan--vicuna-7b-v1.5-W8A8-Dynamic-Per-Token/snapshots/d607e7f6393d17f42e546fa2827484d69de6dd29', speculative_config=None, tokenizer='/home/chaanan/.cache/huggingface/hub/models--Chaanan--vicuna-7b-v1.5-W8A8-Dynamic-Per-Token/snapshots/d607e7f6393d17f42e546fa2827484d69de6dd29', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, override_neuron_config=None, rope_scaling=None, rope_theta=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, max_seq_len=4096, download_dir=None, load_format=LoadFormat.AUTO, tensor_parallel_size=1, pipeline_parallel_size=1, disable_custom_all_reduce=False, quantization=compressed-tensors, enforce_eager=False, kv_cache_dtype=auto, quantization_param_path=None, device_config=cuda, decoding_config=DecodingConfig(guided_decoding_backend='outlines'), observability_config=ObservabilityConfig(otlp_traces_endpoint=None, collect_model_forward_time=False, collect_model_execute_time=False), seed=0, served_model_name=/home/chaanan/.cache/huggingface/hub/models--Chaanan--vicuna-7b-v1.5-W8A8-Dynamic-Per-Token/snapshots/d607e7f6393d17f42e546fa2827484d69de6dd29, use_v2_block_manager=False, num_scheduler_steps=1, enable_prefix_caching=True, use_async_output_proc=True)
INFO 09-17 11:02:14 model_runner.py:915] Starting to load model /home/chaanan/.cache/huggingface/hub/models--Chaanan--vicuna-7b-v1.5-W8A8-Dynamic-Per-Token/snapshots/d607e7f6393d17f42e546fa2827484d69de6dd29...
Loading safetensors checkpoint shards:   0% Completed | 0/2 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  50% Completed | 1/2 [00:01<00:01,  1.59s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.02s/it]
Loading safetensors checkpoint shards: 100% Completed | 2/2 [00:02<00:00,  1.11s/it]

INFO 09-17 11:02:17 model_runner.py:926] Loading model weights took 6.5573 GB
INFO 09-17 11:02:18 gpu_executor.py:122] # GPU blocks: 3618, # CPU blocks: 512
INFO 09-17 11:02:20 model_runner.py:1217] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 09-17 11:02:20 model_runner.py:1221] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 09-17 11:02:31 model_runner.py:1335] Graph capturing finished in 11 secs.
INFO 09-17 11:02:31 block_manager_v1.py:263] Automatic prefix caching is enabled.
Processed prompts:   0%|                                                                                                                                                                                        | 0/20 [00:00<?, ?it/s, est. speed input: 0.00 toks/s, output: 0.00 toks/s]INFO 09-17 11:02:31 metrics.py:351] Avg prompt throughput: 6769.1 tokens/s, Avg generation throughput: 130.7 tokens/s, Running: 20 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:31 metrics.py:367] Prefix cache hit rate: GPU: 47.50%, CPU: 0.00%
INFO 09-17 11:02:31 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1198.4 tokens/s, Running: 20 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:31 metrics.py:367] Prefix cache hit rate: GPU: 47.50%, CPU: 0.00%
INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1201.0 tokens/s, Running: 20 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 40.43%, CPU: 0.00%
INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1201.9 tokens/s, Running: 20 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.7%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 38.00%, CPU: 0.00%
INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1200.6 tokens/s, Running: 20 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.9%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 35.51%, CPU: 0.00%
INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1187.5 tokens/s, Running: 20 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 2.3%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 31.67%, CPU: 0.00%
INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1197.9 tokens/s, Running: 20 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 2.3%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 31.40%, CPU: 0.00%
INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1199.7 tokens/s, Running: 20 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 2.7%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 28.36%, CPU: 0.00%
Processed prompts:   5%|████████▋                                                                                                                                                                     | 1/20 [00:00<00:17,  1.06it/s, est. speed input: 50.83 toks/s, output: 50.83 toks/s]INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1151.5 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 2.7%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 27.34%, CPU: 0.00%
INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1143.7 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 2.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 26.21%, CPU: 0.00%
INFO 09-17 11:02:32 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1141.8 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 3.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:32 metrics.py:367] Prefix cache hit rate: GPU: 24.05%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1144.6 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 3.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 23.90%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1115.6 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 3.6%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 21.84%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1075.8 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 3.7%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 21.47%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1071.8 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 3.9%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 20.77%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1069.8 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.3%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 19.39%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1072.3 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.3%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 19.39%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1069.4 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 18.45%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1069.1 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 17.67%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1065.5 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 17.59%, CPU: 0.00%
INFO 09-17 11:02:33 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1067.7 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:33 metrics.py:367] Prefix cache hit rate: GPU: 16.45%, CPU: 0.00%
INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1064.6 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.3%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 16.24%, CPU: 0.00%
INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1068.1 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 15.83%, CPU: 0.00%
INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1066.5 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 15.02%, CPU: 0.00%
INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1066.8 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 15.02%, CPU: 0.00%
INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1063.1 tokens/s, Running: 19 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 6.1%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 14.45%, CPU: 0.00%
Processed prompts:  10%|█████████████████▍                                                                                                                                                            | 2/20 [00:02<00:28,  1.56s/it, est. speed input: 35.03 toks/s, output: 71.43 toks/s]INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1049.1 tokens/s, Running: 18 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 6.0%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 13.97%, CPU: 0.00%
INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1015.2 tokens/s, Running: 18 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 6.1%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 13.92%, CPU: 0.00%
INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1007.8 tokens/s, Running: 18 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 6.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 13.24%, CPU: 0.00%
Processed prompts:  15%|█████████████████████████▉                                                                                                                                                   | 3/20 [00:03<00:16,  1.00it/s, est. speed input: 46.92 toks/s, output: 119.60 toks/s]INFO 09-17 11:02:34 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 996.8 tokens/s, Running: 17 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 6.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:34 metrics.py:367] Prefix cache hit rate: GPU: 13.10%, CPU: 0.00%
INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 923.2 tokens/s, Running: 15 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.6%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 12.88%, CPU: 0.00%
INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 901.1 tokens/s, Running: 14 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 12.42%, CPU: 0.00%
Processed prompts:  30%|███████████████████████████████████████████████████▉                                                                                                                         | 6/20 [00:03<00:05,  2.57it/s, est. speed input: 90.01 toks/s, output: 272.32 toks/s]INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 845.6 tokens/s, Running: 14 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 12.42%, CPU: 0.00%
Processed prompts:  35%|████████████████████████████████████████████████████████████▌                                                                                                                | 7/20 [00:03<00:04,  2.94it/s, est. speed input: 99.13 toks/s, output: 314.49 toks/s]INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 816.5 tokens/s, Running: 13 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 12.03%, CPU: 0.00%
INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 768.0 tokens/s, Running: 13 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 11.91%, CPU: 0.00%
INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 763.9 tokens/s, Running: 13 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 11.80%, CPU: 0.00%
Processed prompts:  40%|████████████████████████████████████████████████████████████████████▊                                                                                                       | 8/20 [00:03<00:03,  3.10it/s, est. speed input: 106.22 toks/s, output: 348.75 toks/s]INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 727.0 tokens/s, Running: 12 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 11.45%, CPU: 0.00%
INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 716.1 tokens/s, Running: 12 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 11.45%, CPU: 0.00%
Processed prompts:  45%|█████████████████████████████████████████████████████████████████████████████▍                                                                                              | 9/20 [00:04<00:03,  3.39it/s, est. speed input: 112.40 toks/s, output: 386.56 toks/s]INFO 09-17 11:02:35 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 682.9 tokens/s, Running: 11 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.1%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:35 metrics.py:367] Prefix cache hit rate: GPU: 11.24%, CPU: 0.00%
INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 663.5 tokens/s, Running: 11 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 11.08%, CPU: 0.00%
INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 662.4 tokens/s, Running: 11 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 5.3%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 11.01%, CPU: 0.00%
Processed prompts:  50%|█████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 10/20 [00:04<00:03,  3.28it/s, est. speed input: 115.64 toks/s, output: 414.39 toks/s]INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 603.9 tokens/s, Running: 9 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 10.73%, CPU: 0.00%
INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 555.3 tokens/s, Running: 9 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 10.73%, CPU: 0.00%
Processed prompts:  60%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                    | 12/20 [00:04<00:01,  4.38it/s, est. speed input: 130.72 toks/s, output: 501.88 toks/s]INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 532.9 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 10.53%, CPU: 0.00%
INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 514.6 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.3%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 10.50%, CPU: 0.00%
INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 512.4 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 10.30%, CPU: 0.00%
INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 509.3 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 10.27%, CPU: 0.00%
INFO 09-17 11:02:36 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 512.1 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:36 metrics.py:367] Prefix cache hit rate: GPU: 10.22%, CPU: 0.00%
INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 510.1 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.7%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 10.05%, CPU: 0.00%
INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 509.8 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.7%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 10.05%, CPU: 0.00%
Processed prompts:  65%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                           | 13/20 [00:05<00:02,  2.86it/s, est. speed input: 123.02 toks/s, output: 492.26 toks/s]INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 472.6 tokens/s, Running: 7 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 4.3%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 9.84%, CPU: 0.00%
INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 368.2 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 3.1%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 9.84%, CPU: 0.00%
INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 335.0 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 3.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 9.74%, CPU: 0.00%
INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 330.2 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 3.2%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 9.72%, CPU: 0.00%
Processed prompts:  80%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                  | 16/20 [00:05<00:00,  4.18it/s, est. speed input: 141.26 toks/s, output: 627.12 toks/s]INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 267.9 tokens/s, Running: 3 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 2.0%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 9.69%, CPU: 0.00%
INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 209.4 tokens/s, Running: 3 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 2.0%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 9.64%, CPU: 0.00%
Processed prompts:  90%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                 | 18/20 [00:06<00:00,  5.02it/s, est. speed input: 152.88 toks/s, output: 718.73 toks/s]INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 167.0 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 9.64%, CPU: 0.00%
INFO 09-17 11:02:37 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 144.3 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:37 metrics.py:367] Prefix cache hit rate: GPU: 9.60%, CPU: 0.00%
INFO 09-17 11:02:38 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 144.6 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.4%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:38 metrics.py:367] Prefix cache hit rate: GPU: 9.60%, CPU: 0.00%
INFO 09-17 11:02:38 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 144.3 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 1.5%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:38 metrics.py:367] Prefix cache hit rate: GPU: 9.55%, CPU: 0.00%
Processed prompts:  95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 19/20 [00:06<00:00,  4.12it/s, est. speed input: 150.63 toks/s, output: 731.02 toks/s]INFO 09-17 11:02:38 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 91.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:38 metrics.py:367] Prefix cache hit rate: GPU: 9.55%, CPU: 0.00%
INFO 09-17 11:02:38 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 74.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:38 metrics.py:367] Prefix cache hit rate: GPU: 9.52%, CPU: 0.00%
INFO 09-17 11:02:38 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 73.8 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:38 metrics.py:367] Prefix cache hit rate: GPU: 9.52%, CPU: 0.00%
INFO 09-17 11:02:38 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 74.3 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:38 metrics.py:367] Prefix cache hit rate: GPU: 9.50%, CPU: 0.00%
INFO 09-17 11:02:38 metrics.py:351] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 74.3 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.8%, CPU KV cache usage: 0.0%.
INFO 09-17 11:02:38 metrics.py:367] Prefix cache hit rate: GPU: 9.50%, CPU: 0.00%
Processed prompts: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 20/20 [00:07<00:00,  2.80it/s, est. speed input: 145.10 toks/s, output: 732.21 toks/s]
(vllm_main) chaanan@a100-1:~/vllm/amun$ 